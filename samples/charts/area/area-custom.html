<!DOCTYPE html>
<html lang="en-US">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=Edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>area > boundaries | Chart.js sample</title>
	<link rel="stylesheet" type="text/css" href="../../style.css">
	<script src="../../../dist/Chart.bundle.js"></script>
	<script src="../../utils.js"></script>
	<script src="analyser.js"></script>
</head>
<body>
	<div class="content">
		<div class="wrapper col-2"><canvas id="chart-2"></canvas></div>

		<div class="toolbar">
			<button onclick="toggleSmooth(this)">Smooth</button>
			<button onclick="randomize(this)">Randomize</button>
		</div>
	</div>

	<script>
	Chart.defaults.LineWithLine = Chart.defaults.line;
	Chart.controllers.LineWithLine = Chart.controllers.line.extend({
		draw: function(ease) {
			Chart.controllers.line.prototype.draw.call(this, ease);

			if (this.chart.tooltip._active && this.chart.tooltip._active.length) {
				 var activePoint = this.chart.tooltip._active[0],
						 ctx = this.chart.ctx,
						 x = activePoint.tooltipPosition().x,
						 topY = this.chart.scales['y-axis-0'].top,
						 bottomY = this.chart.scales['y-axis-0'].bottom;

				 // draw line
				 ctx.save();
				 ctx.beginPath();
				 ctx.moveTo(x, topY);
				 ctx.lineTo(x, bottomY);
				 ctx.lineWidth = 1;
				 ctx.strokeStyle = '#444';
				 ctx.stroke();
				 ctx.restore();
			}
		}
	});

		var presets = window.chartColors;
		var utils = Samples.utils;
		var inputs = {
			min: -100,
			max: 100,
			count: 8,
			decimals: 2,
			continuity: 1
		};

		function generateData(config) {
			return utils.numbers(Chart.helpers.merge(inputs, config || {}));
		}

		function generateLabels(config) {
			return utils.months(Chart.helpers.merge({
				count: inputs.count,
				section: 3
			}, config || {}));
		}

		var options = {
			tooltips: {
        intersect: false,
				custom: function(tooltip) {
          // tooltip will be false if tooltip is not visible or should be hidden
          if (!tooltip) {
            return;
          }
          tooltip.title = [];
          tooltip.displayColors = false;
          tooltip.backgroundColor = 'transparent';
          tooltip.labelTextColors = '#444';
					if (tooltip.body) {
						tooltip.body[0].lines = [`${tooltip.dataPoints[0].yLabel}m`]
					}
					console.log('tooltip', tooltip);
	      }
      },
			maintainAspectRatio: false,
			spanGaps: false,
			elements: {
				line: {
					tension: 0.000001
				}
			},
			plugins: {
				filler: {
					propagate: false
				}
			},
			scales: {
				xAxes: [{
					ticks: {
						autoSkip: false,
						maxRotation: 0
					}
				}]
			},
			annotation: {
				onMousemove: function (e) {
					console.log('onMousemove', e)
				}
			}
		};



		// reset the random seed to generate the same data for all charts
		utils.srand(8);

		new Chart('chart-2', {
			type: 'LineWithLine',
			data: {
				labels: generateLabels(),
				datasets: [{
					backgroundColor: utils.transparentize(presets.red),
					borderColor: presets.red,
					data: generateData(),
					label: 'Dataset',
					fill: 'start'
				}]
			},
			plugins: ['chartjs-plugin-annotation'],
			options: Chart.helpers.merge(options, {
				title: {
					text: 'fill: start',
					display: true
				}
			})
		});


		// eslint-disable-next-line no-unused-vars
		function toggleSmooth(btn) {
			var value = btn.classList.toggle('btn-on');
			Chart.helpers.each(Chart.instances, function(chart) {
				chart.options.elements.line.tension = value ? 0.4 : 0.000001;
				chart.update();
			});
		}

		// eslint-disable-next-line no-unused-vars
		function randomize() {
			var seed = utils.rand();
			Chart.helpers.each(Chart.instances, function(chart) {
				utils.srand(seed);

				chart.data.datasets.forEach(function(dataset) {
					dataset.data = generateData();
				});

				chart.update();
			});
		}
	</script>
</body>
</html>
